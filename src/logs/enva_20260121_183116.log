2026-01-21 18:31:16 - main                      - INFO - === Redeploy: Cleanup and Deploy ===
2026-01-21 18:31:16 - main                      - INFO - 
[1/2] Running cleanup...
2026-01-21 18:31:16 - cleanup                   - INFO - === Cleaning Up Lab Environment ===
2026-01-21 18:31:16 - cleanup                   - INFO - Destroying ALL containers and templates...
2026-01-21 18:31:16 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:31:16 - cleanup                   - INFO - Stopping and destroying containers...
2026-01-21 18:31:17 - cleanup                   - INFO - No containers found
2026-01-21 18:31:17 - cleanup                   - INFO - Removing templates...
2026-01-21 18:31:17 - cleanup                   - INFO - Cleaning template directory /var/lib/vz/template/cache...
2026-01-21 18:31:17 - cleanup                   - INFO - Removing 1 template files...
2026-01-21 18:31:17 - cleanup                   - INFO - Templates removed
2026-01-21 18:31:17 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:31:17 - main                      - INFO - 
[2/2] Running deploy...
2026-01-21 18:31:17 - deploy                    - INFO - 
2026-01-21 18:31:17 - deploy                    - INFO - Deploy plan (total 39 steps, running 1-39):
2026-01-21 18:31:17 - deploy                    - INFO -   [ 1] RUN  ubuntu-tmpl: create template
2026-01-21 18:31:17 - deploy                    - INFO -   [ 2] RUN  ubuntu-tmpl: locale configuration
2026-01-21 18:31:17 - deploy                    - INFO -   [ 3] RUN  ubuntu-tmpl: apt sources fix
2026-01-21 18:31:17 - deploy                    - INFO -   [ 4] RUN  ubuntu-tmpl: system upgrade
2026-01-21 18:31:17 - deploy                    - INFO -   [ 5] RUN  ubuntu-tmpl: openssh-server installation
2026-01-21 18:31:17 - deploy                    - INFO -   [ 6] RUN  ubuntu-tmpl: SSH service enablement
2026-01-21 18:31:17 - deploy                    - INFO -   [ 7] RUN  ubuntu-tmpl: base tools installation
2026-01-21 18:31:17 - deploy                    - INFO -   [ 8] RUN  ubuntu-tmpl: template cleanup
2026-01-21 18:31:17 - deploy                    - INFO -   [ 9] RUN  ubuntu-tmpl: template archive creation
2026-01-21 18:31:17 - deploy                    - INFO -   [10] RUN  haproxy: create container
2026-01-21 18:31:17 - deploy                    - INFO -   [11] RUN  haproxy: cloud-init wait
2026-01-21 18:31:17 - deploy                    - INFO -   [12] RUN  haproxy: haproxy installation
2026-01-21 18:31:17 - deploy                    - INFO -   [13] RUN  haproxy: haproxy configuration
2026-01-21 18:31:17 - deploy                    - INFO -   [14] RUN  haproxy: haproxy systemd override
2026-01-21 18:31:17 - deploy                    - INFO -   [15] RUN  haproxy: haproxy service enablement
2026-01-21 18:31:17 - deploy                    - INFO -   [16] RUN  k3s-control: create container
2026-01-21 18:31:17 - deploy                    - INFO -   [17] RUN  k3s-control: cloud-init wait
2026-01-21 18:31:17 - deploy                    - INFO -   [18] RUN  k3s-control: lxc sysctl access configuration
2026-01-21 18:31:17 - deploy                    - INFO -   [19] RUN  k3s-control: k3s installation
2026-01-21 18:31:17 - deploy                    - INFO -   [20] RUN  k3s-control: install k3s node watcher
2026-01-21 18:31:17 - deploy                    - INFO -   [21] RUN  k3s-worker-1: create container
2026-01-21 18:31:17 - deploy                    - INFO -   [22] RUN  k3s-worker-1: cloud-init wait
2026-01-21 18:31:17 - deploy                    - INFO -   [23] RUN  k3s-worker-1: lxc sysctl access configuration
2026-01-21 18:31:17 - deploy                    - INFO -   [24] RUN  k3s-worker-1: k3s installation
2026-01-21 18:31:17 - deploy                    - INFO -   [25] RUN  k3s-worker-1: glusterfs server installation
2026-01-21 18:31:17 - deploy                    - INFO -   [26] RUN  k3s-worker-2: create container
2026-01-21 18:31:17 - deploy                    - INFO -   [27] RUN  k3s-worker-2: cloud-init wait
2026-01-21 18:31:17 - deploy                    - INFO -   [28] RUN  k3s-worker-2: lxc sysctl access configuration
2026-01-21 18:31:17 - deploy                    - INFO -   [29] RUN  k3s-worker-2: k3s installation
2026-01-21 18:31:17 - deploy                    - INFO -   [30] RUN  k3s-worker-2: glusterfs server installation
2026-01-21 18:31:17 - deploy                    - INFO -   [31] RUN  k3s-worker-3: create container
2026-01-21 18:31:17 - deploy                    - INFO -   [32] RUN  k3s-worker-3: cloud-init wait
2026-01-21 18:31:17 - deploy                    - INFO -   [33] RUN  k3s-worker-3: lxc sysctl access configuration
2026-01-21 18:31:17 - deploy                    - INFO -   [34] RUN  k3s-worker-3: k3s installation
2026-01-21 18:31:17 - deploy                    - INFO -   [35] RUN  k3s-worker-3: glusterfs server installation
2026-01-21 18:31:17 - deploy                    - INFO -   [36] RUN  kubernetes: setup kubernetes
2026-01-21 18:31:17 - deploy                    - INFO -   [37] RUN  glusterfs: setup glusterfs
2026-01-21 18:31:17 - deploy                    - INFO -   [38] RUN  kubernetes: install rancher
2026-01-21 18:31:17 - deploy                    - INFO -   [39] RUN  kubernetes: install argocd
2026-01-21 18:31:17 - deploy                    - INFO - === Executing Deployment ===
2026-01-21 18:31:17 - deploy                    - INFO - === [Overall: 2%] [Step: 1/39] Executing: ubuntu-tmpl - create container ===
2026-01-21 18:31:18 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:31:19 - template                  - INFO - Base template not found. Downloading ubuntu-25.04-standard_25.04-1.1_amd64.tar.zst...
2026-01-21 18:31:19 - template                  - INFO - Updating Proxmox repository cache...
2026-01-21 18:31:22 - template                  - INFO - Repository cache updated successfully
2026-01-21 18:31:27 - template                  - INFO - Template ubuntu-25.04-standard_25.04-1.1_amd64.tar.zst downloaded successfully
2026-01-21 18:31:27 - create_container          - INFO - Checking if container 4010 already exists...
2026-01-21 18:31:28 - create_container          - INFO - Creating container 4010 from template...
2026-01-21 18:31:35 - create_container          - INFO - Setting container features...
2026-01-21 18:31:36 - create_container          - INFO - Setting autostart for container 4010 (onboot=1)...
2026-01-21 18:31:37 - create_container          - INFO - Starting container 4010...
2026-01-21 18:31:41 - create_container          - INFO - Bringing up network interface...
2026-01-21 18:31:43 - create_container          - INFO - Network interface is up and reachable
2026-01-21 18:31:45 - create_container          - INFO - Password set for user jaal
2026-01-21 18:31:51 - common                    - INFO - SSH key setup verified successfully
2026-01-21 18:31:55 - create_container          - INFO - Waiting for container to be ready with SSH connectivity (up to 10 minutes)...
2026-01-21 18:31:56 - pct                       - INFO - Container is up!
2026-01-21 18:31:56 - create_container          - INFO - Container 4010 created successfully
2026-01-21 18:31:56 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:31:56 - deploy                    - INFO - Container 'ubuntu-tmpl' created successfully
2026-01-21 18:31:56 - deploy                    - INFO - Setting up SSH connection to container ubuntu-tmpl...
2026-01-21 18:31:56 - ssh                       - INFO - SSH connection established to jaal@10.11.4.10
2026-01-21 18:31:58 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:31:58 - deploy                    - INFO - === [Overall: 5%] [Step: 2/39] Executing: ubuntu-tmpl - locale configuration ===
2026-01-21 18:31:58 - locale_configuration      - INFO - Configuring locale settings...
2026-01-21 18:31:58 - locale_configuration      - INFO - Generating locale en_US.UTF-8...
2026-01-21 18:32:03 - locale_configuration      - INFO - Setting LC_CTYPE=en_US.UTF-8...
2026-01-21 18:32:04 - locale_configuration      - INFO - Verifying locale configuration...
2026-01-21 18:32:05 - locale_configuration      - INFO - Locale configuration completed successfully
2026-01-21 18:32:05 - deploy                    - INFO - Action 'locale configuration' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:32:05 - deploy                    - INFO - === [Overall: 7%] [Step: 3/39] Executing: ubuntu-tmpl - apt sources fix ===
2026-01-21 18:32:06 - fix_apt_sources           - INFO - sources.list not found (may use sources.list.d), skipping fix
2026-01-21 18:32:08 - fix_apt_sources           - INFO - sources.list not found (may use sources.list.d), skipping fix
2026-01-21 18:32:08 - deploy                    - INFO - Action 'apt sources fix' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:32:08 - deploy                    - INFO - === [Overall: 10%] [Step: 4/39] Executing: ubuntu-tmpl - system upgrade ===
2026-01-21 18:33:34 - deploy                    - INFO - Action 'system upgrade' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:33:34 - deploy                    - INFO - === [Overall: 12%] [Step: 5/39] Executing: ubuntu-tmpl - openssh-server installation ===
2026-01-21 18:33:34 - install_openssh_server    - INFO - Installing openssh-server package...
2026-01-21 18:33:37 - deploy                    - INFO - Action 'openssh-server installation' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:33:37 - deploy                    - INFO - === [Overall: 15%] [Step: 6/39] Executing: ubuntu-tmpl - SSH service enablement ===
2026-01-21 18:33:40 - deploy                    - INFO - Action 'SSH service enablement' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:33:40 - deploy                    - INFO - === [Overall: 17%] [Step: 7/39] Executing: ubuntu-tmpl - base tools installation ===
2026-01-21 18:33:46 - deploy                    - INFO - Action 'base tools installation' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:33:46 - deploy                    - INFO - === [Overall: 20%] [Step: 8/39] Executing: ubuntu-tmpl - template cleanup ===
2026-01-21 18:33:58 - deploy                    - INFO - Action 'template cleanup' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:33:58 - deploy                    - INFO - === [Overall: 23%] [Step: 9/39] Executing: ubuntu-tmpl - template archive creation ===
2026-01-21 18:33:59 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:33:59 - create_template_archive   - INFO - Stopping container...
2026-01-21 18:34:04 - create_template_archive   - INFO - Creating template archive for container 4010 in directory /var/lib/vz/template/cache
2026-01-21 18:34:04 - create_template_archive   - INFO - Executing vzdump command: vzdump 4010 --dumpdir /var/lib/vz/template/cache --compress zstd --mode stop
2026-01-21 18:34:12 - create_template_archive   - INFO - vzdump output (first 500 chars): INFO: Starting Backup of VM 4010 (lxc)
INFO: Backup started at 2026-01-21 18:34:05
INFO: status = stopped
INFO: backup mode: stop
INFO: ionice priority: 7
INFO: CT Name: ubuntu-tmpl
INFO: including mount point rootfs ('/') in backup
INFO: creating vzdump archive '/var/lib/vz/template/cache/vzdump-lxc-4010-2026_01_21-18_34_05.tar.zst'
INFO: Total bytes written: 554752000 (530MiB, 90MiB/s)
INFO: archive file size: 160MB
INFO: Finished Backup of VM 4010 (00:00:07)
INFO: Backup finished at 2026-01-2
2026-01-21 18:34:12 - create_template_archive   - INFO - Template archive file found: /var/lib/vz/template/cache/vzdump-lxc-4010-2026_01_21-18_34_05.tar.zst
2026-01-21 18:34:12 - create_template_archive   - INFO - Template archive size: 160,75 MB
2026-01-21 18:34:12 - create_template_archive   - INFO - Final template name: ubuntu-tmpl_20260121_amd64.tar.zst
2026-01-21 18:34:12 - create_template_archive   - INFO - Moving template from /var/lib/vz/template/cache/vzdump-lxc-4010-2026_01_21-18_34_05.tar.zst to /var/lib/vz/template/cache/ubuntu-tmpl_20260121_amd64.tar.zst
2026-01-21 18:34:12 - create_template_archive   - INFO - Template moved to storage location: /var/lib/vz/template/cache/ubuntu-tmpl_20260121_amd64.tar.zst
2026-01-21 18:34:14 - create_template_archive   - INFO - Cleaning up other template archives...
2026-01-21 18:34:15 - common                    - INFO - Stopping and destroying container 4010...
2026-01-21 18:34:21 - common                    - INFO - Container 4010 destroyed
2026-01-21 18:34:21 - create_template_archive   - INFO - Container 4010 destroyed after template archive creation
2026-01-21 18:34:21 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:34:21 - deploy                    - INFO - Action 'template archive creation' for container 'ubuntu-tmpl' completed successfully
2026-01-21 18:34:21 - ssh                       - INFO - SSH connection closed to jaal@10.11.4.10
2026-01-21 18:34:21 - deploy                    - INFO - Destroying template container 4010 after processing...
2026-01-21 18:34:22 - common                    - INFO - Container 4010 does not exist, skipping
2026-01-21 18:34:22 - deploy                    - INFO - === [Overall: 25%] [Step: 10/39] Executing: haproxy - create container ===
2026-01-21 18:34:22 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:34:23 - create_container          - INFO - Checking if container 4017 already exists...
2026-01-21 18:34:25 - create_container          - INFO - Creating container 4017 from template...
2026-01-21 18:34:30 - create_container          - INFO - Setting container features...
2026-01-21 18:34:31 - create_container          - INFO - Setting autostart for container 4017 (onboot=1)...
2026-01-21 18:34:32 - create_container          - INFO - Starting container 4017...
2026-01-21 18:34:37 - create_container          - INFO - Bringing up network interface...
2026-01-21 18:34:38 - create_container          - INFO - Network interface is up and reachable
2026-01-21 18:34:40 - create_container          - INFO - Password set for user jaal
2026-01-21 18:34:46 - common                    - INFO - SSH key setup verified successfully
2026-01-21 18:34:50 - create_container          - INFO - Waiting for container to be ready with SSH connectivity (up to 10 minutes)...
2026-01-21 18:34:52 - pct                       - INFO - Container is up!
2026-01-21 18:34:52 - create_container          - INFO - Container 4017 created successfully
2026-01-21 18:34:52 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:34:52 - deploy                    - INFO - Container 'haproxy' created successfully
2026-01-21 18:34:52 - deploy                    - INFO - Setting up SSH connection to container haproxy...
2026-01-21 18:34:52 - ssh                       - INFO - SSH connection established to jaal@10.11.4.17
2026-01-21 18:34:54 - deploy                    - INFO - === [Overall: 28%] [Step: 11/39] Executing: haproxy - cloud-init wait ===
2026-01-21 18:34:54 - cloud_init_wait           - INFO - cloud-init not found, skipping
2026-01-21 18:34:54 - deploy                    - INFO - Action 'cloud-init wait' for container 'haproxy' completed successfully
2026-01-21 18:34:54 - deploy                    - INFO - === [Overall: 30%] [Step: 12/39] Executing: haproxy - haproxy installation ===
2026-01-21 18:34:54 - install_haproxy           - INFO - Installing haproxy package...
2026-01-21 18:35:06 - deploy                    - INFO - Action 'haproxy installation' for container 'haproxy' completed successfully
2026-01-21 18:35:06 - deploy                    - INFO - === [Overall: 33%] [Step: 13/39] Executing: haproxy - haproxy configuration ===
2026-01-21 18:35:06 - configure_haproxy         - INFO - Using default SSL certificate path: /etc/haproxy/haproxy.pem
2026-01-21 18:35:06 - configure_haproxy         - INFO - Generating self-signed SSL certificate...
2026-01-21 18:35:06 - configure_haproxy         - INFO - SSL certificate generated successfully at /etc/haproxy/haproxy.pem
2026-01-21 18:35:08 - verify_haproxy            - INFO - HAProxy not configured, skipping verification
2026-01-21 18:35:08 - deploy                    - INFO - Action 'haproxy configuration' for container 'haproxy' completed successfully
2026-01-21 18:35:08 - deploy                    - INFO - === [Overall: 35%] [Step: 14/39] Executing: haproxy - haproxy systemd override ===
2026-01-21 18:35:09 - deploy                    - INFO - Action 'haproxy systemd override' for container 'haproxy' completed successfully
2026-01-21 18:35:09 - deploy                    - INFO - === [Overall: 38%] [Step: 15/39] Executing: haproxy - haproxy service enablement ===
2026-01-21 18:35:12 - deploy                    - INFO - Action 'haproxy service enablement' for container 'haproxy' completed successfully
2026-01-21 18:35:12 - ssh                       - INFO - SSH connection closed to jaal@10.11.4.17
2026-01-21 18:35:12 - deploy                    - INFO - === [Overall: 41%] [Step: 16/39] Executing: k3s-control - create container ===
2026-01-21 18:35:12 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:35:13 - create_container          - INFO - Checking if container 4011 already exists...
2026-01-21 18:35:14 - create_container          - INFO - Creating container 4011 from template...
2026-01-21 18:35:21 - create_container          - INFO - Setting container features...
2026-01-21 18:35:22 - create_container          - INFO - Setting autostart for container 4011 (onboot=1)...
2026-01-21 18:35:23 - create_container          - INFO - Starting container 4011...
2026-01-21 18:35:27 - create_container          - INFO - Bringing up network interface...
2026-01-21 18:35:28 - create_container          - INFO - Network interface is up and reachable
2026-01-21 18:35:31 - create_container          - INFO - Password set for user jaal
2026-01-21 18:35:36 - common                    - INFO - SSH key setup verified successfully
2026-01-21 18:35:40 - create_container          - INFO - Waiting for container to be ready with SSH connectivity (up to 10 minutes)...
2026-01-21 18:35:42 - pct                       - INFO - Container is up!
2026-01-21 18:35:42 - create_container          - INFO - Container 4011 created successfully
2026-01-21 18:35:42 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:35:42 - deploy                    - INFO - Container 'k3s-control' created successfully
2026-01-21 18:35:42 - deploy                    - INFO - Setting up SSH connection to container k3s-control...
2026-01-21 18:35:42 - ssh                       - INFO - SSH connection established to jaal@10.11.4.11
2026-01-21 18:35:44 - deploy                    - INFO - === [Overall: 43%] [Step: 17/39] Executing: k3s-control - cloud-init wait ===
2026-01-21 18:35:44 - cloud_init_wait           - INFO - cloud-init not found, skipping
2026-01-21 18:35:44 - deploy                    - INFO - Action 'cloud-init wait' for container 'k3s-control' completed successfully
2026-01-21 18:35:44 - deploy                    - INFO - === [Overall: 46%] [Step: 18/39] Executing: k3s-control - lxc sysctl access configuration ===
2026-01-21 18:35:44 - configure_lxc_sysctl_access - INFO - Configuring LXC container for sysctl access...
2026-01-21 18:35:44 - configure_lxc_sysctl_access - INFO - Adding k3s LXC configuration requirements...
2026-01-21 18:35:44 - configure_lxc_sysctl_access - INFO - Added: lxc.apparmor.profile: unconfined
2026-01-21 18:35:44 - configure_lxc_sysctl_access - INFO - Added: lxc.cap.drop:
2026-01-21 18:35:44 - configure_lxc_sysctl_access - INFO - Added: lxc.mount.auto: proc:rw sys:rw
2026-01-21 18:35:44 - configure_lxc_sysctl_access - INFO - Added: lxc.cgroup2.devices.allow: c 1:11 rwm
2026-01-21 18:35:44 - configure_lxc_sysctl_access - INFO - Container needs to be restarted for k3s LXC configuration to take effect...
2026-01-21 18:35:53 - configure_lxc_sysctl_access - INFO - Container restarted to apply k3s LXC configuration
2026-01-21 18:35:58 - configure_lxc_sysctl_access - INFO - Ensuring /dev/kmsg is configured as symlink to /dev/console (k3s LXC requirement)...
2026-01-21 18:35:59 - configure_lxc_sysctl_access - INFO - /dev/kmsg symlink configured successfully
2026-01-21 18:35:59 - deploy                    - INFO - Action 'lxc sysctl access configuration' for container 'k3s-control' completed successfully
2026-01-21 18:35:59 - deploy                    - INFO - === [Overall: 48%] [Step: 19/39] Executing: k3s-control - k3s installation ===
2026-01-21 18:35:59 - install_k3s               - INFO - Installing k3s...
2026-01-21 18:36:00 - ssh                       - INFO - SSH connection established to jaal@10.11.4.11
2026-01-21 18:36:00 - install_k3s               - INFO - Creating /dev/kmsg device for k3s...
2026-01-21 18:36:00 - install_k3s               - INFO - /dev/kmsg symlink verified: lrwxrwxrwx 1 root root 12 Jan 21 16:36 /dev/kmsg -> /dev/console
2026-01-21 18:36:00 - install_k3s               - INFO - Installing k3s server (control node)...
2026-01-21 18:36:00 - install_k3s               - INFO - k3s config file created successfully
2026-01-21 18:36:17 - install_k3s               - INFO - k3s installed successfully: k3s version v1.34.3+k3s1 (48ffa7b6)
go version go1.24.11
2026-01-21 18:36:17 - install_k3s               - INFO - Configuring systemd service to ensure /dev/kmsg exists on startup...
2026-01-21 18:36:17 - install_k3s               - INFO - ✓ Added /dev/kmsg fix to k3s.service
2026-01-21 18:36:17 - install_k3s               - INFO - ✓ Systemd daemon reloaded
2026-01-21 18:36:17 - install_k3s               - INFO - Setting up kubectl PATH and kubeconfig...
2026-01-21 18:36:17 - install_k3s               - INFO - k3s kubeconfig generated
2026-01-21 18:36:17 - install_k3s               - INFO - kubeconfig setup completed
2026-01-21 18:36:17 - deploy                    - INFO - Action 'k3s installation' for container 'k3s-control' completed successfully
2026-01-21 18:36:17 - deploy                    - INFO - === [Overall: 51%] [Step: 20/39] Executing: k3s-control - install k3s node watcher ===
2026-01-21 18:36:17 - install_k3s_node_watcher  - INFO - Installing k3s node watcher service on control node 4011...
2026-01-21 18:36:18 - install_k3s_node_watcher  - INFO - ✓ k3s node watcher installed and enabled (runs every 2 minutes)
2026-01-21 18:36:18 - deploy                    - INFO - Action 'install k3s node watcher' for container 'k3s-control' completed successfully
2026-01-21 18:36:18 - ssh                       - INFO - SSH connection closed to jaal@10.11.4.11
2026-01-21 18:36:18 - deploy                    - INFO - === [Overall: 53%] [Step: 21/39] Executing: k3s-worker-1 - create container ===
2026-01-21 18:36:18 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:36:19 - create_container          - INFO - Checking if container 4012 already exists...
2026-01-21 18:36:20 - create_container          - INFO - Creating container 4012 from template...
2026-01-21 18:36:27 - create_container          - INFO - Setting container features...
2026-01-21 18:36:28 - create_container          - INFO - Setting autostart for container 4012 (onboot=1)...
2026-01-21 18:36:29 - create_container          - INFO - Starting container 4012...
2026-01-21 18:36:33 - create_container          - INFO - Bringing up network interface...
2026-01-21 18:36:35 - create_container          - INFO - Network interface is up and reachable
2026-01-21 18:36:37 - create_container          - INFO - Password set for user jaal
2026-01-21 18:36:43 - common                    - INFO - SSH key setup verified successfully
2026-01-21 18:36:47 - create_container          - INFO - Waiting for container to be ready with SSH connectivity (up to 10 minutes)...
2026-01-21 18:36:48 - pct                       - INFO - Container is up!
2026-01-21 18:36:48 - create_container          - INFO - Container 4012 created successfully
2026-01-21 18:36:48 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:36:48 - deploy                    - INFO - Container 'k3s-worker-1' created successfully
2026-01-21 18:36:48 - deploy                    - INFO - Setting up SSH connection to container k3s-worker-1...
2026-01-21 18:36:48 - ssh                       - INFO - SSH connection established to jaal@10.11.4.12
2026-01-21 18:36:50 - deploy                    - INFO - === [Overall: 56%] [Step: 22/39] Executing: k3s-worker-1 - cloud-init wait ===
2026-01-21 18:36:50 - cloud_init_wait           - INFO - cloud-init not found, skipping
2026-01-21 18:36:50 - deploy                    - INFO - Action 'cloud-init wait' for container 'k3s-worker-1' completed successfully
2026-01-21 18:36:50 - deploy                    - INFO - === [Overall: 58%] [Step: 23/39] Executing: k3s-worker-1 - lxc sysctl access configuration ===
2026-01-21 18:36:50 - configure_lxc_sysctl_access - INFO - Configuring LXC container for sysctl access...
2026-01-21 18:36:50 - configure_lxc_sysctl_access - INFO - Adding k3s LXC configuration requirements...
2026-01-21 18:36:50 - configure_lxc_sysctl_access - INFO - Added: lxc.apparmor.profile: unconfined
2026-01-21 18:36:50 - configure_lxc_sysctl_access - INFO - Added: lxc.cap.drop:
2026-01-21 18:36:50 - configure_lxc_sysctl_access - INFO - Added: lxc.mount.auto: proc:rw sys:rw
2026-01-21 18:36:50 - configure_lxc_sysctl_access - INFO - Added: lxc.cgroup2.devices.allow: c 1:11 rwm
2026-01-21 18:36:50 - configure_lxc_sysctl_access - INFO - Container needs to be restarted for k3s LXC configuration to take effect...
2026-01-21 18:36:59 - configure_lxc_sysctl_access - INFO - Container restarted to apply k3s LXC configuration
2026-01-21 18:37:04 - configure_lxc_sysctl_access - INFO - Ensuring /dev/kmsg is configured as symlink to /dev/console (k3s LXC requirement)...
2026-01-21 18:37:06 - configure_lxc_sysctl_access - INFO - /dev/kmsg symlink configured successfully
2026-01-21 18:37:06 - deploy                    - INFO - Action 'lxc sysctl access configuration' for container 'k3s-worker-1' completed successfully
2026-01-21 18:37:06 - deploy                    - INFO - === [Overall: 61%] [Step: 24/39] Executing: k3s-worker-1 - k3s installation ===
2026-01-21 18:37:06 - install_k3s               - INFO - Installing k3s...
2026-01-21 18:37:06 - ssh                       - INFO - SSH connection established to jaal@10.11.4.12
2026-01-21 18:37:06 - install_k3s               - INFO - Skipping k3s agent installation for worker node (will be installed during orchestration)...
2026-01-21 18:37:06 - deploy                    - INFO - Action 'k3s installation' for container 'k3s-worker-1' completed successfully
2026-01-21 18:37:06 - deploy                    - INFO - === [Overall: 64%] [Step: 25/39] Executing: k3s-worker-1 - glusterfs server installation ===
2026-01-21 18:37:06 - install_glusterfs         - INFO - Installing glusterfs-server package...
2026-01-21 18:37:28 - deploy                    - INFO - Action 'glusterfs server installation' for container 'k3s-worker-1' completed successfully
2026-01-21 18:37:28 - ssh                       - INFO - SSH connection closed to jaal@10.11.4.12
2026-01-21 18:37:28 - deploy                    - INFO - === [Overall: 66%] [Step: 26/39] Executing: k3s-worker-2 - create container ===
2026-01-21 18:37:28 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:37:30 - create_container          - INFO - Checking if container 4013 already exists...
2026-01-21 18:37:31 - create_container          - INFO - Creating container 4013 from template...
2026-01-21 18:37:38 - create_container          - INFO - Setting container features...
2026-01-21 18:37:39 - create_container          - INFO - Setting autostart for container 4013 (onboot=1)...
2026-01-21 18:37:41 - create_container          - INFO - Starting container 4013...
2026-01-21 18:37:45 - create_container          - INFO - Bringing up network interface...
2026-01-21 18:37:46 - create_container          - INFO - Network interface is up and reachable
2026-01-21 18:37:48 - create_container          - INFO - Password set for user jaal
2026-01-21 18:37:54 - common                    - INFO - SSH key setup verified successfully
2026-01-21 18:37:58 - create_container          - INFO - Waiting for container to be ready with SSH connectivity (up to 10 minutes)...
2026-01-21 18:37:59 - pct                       - INFO - Container is up!
2026-01-21 18:37:59 - create_container          - INFO - Container 4013 created successfully
2026-01-21 18:37:59 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:37:59 - deploy                    - INFO - Container 'k3s-worker-2' created successfully
2026-01-21 18:37:59 - deploy                    - INFO - Setting up SSH connection to container k3s-worker-2...
2026-01-21 18:37:59 - ssh                       - INFO - SSH connection established to jaal@10.11.4.13
2026-01-21 18:38:01 - deploy                    - INFO - === [Overall: 69%] [Step: 27/39] Executing: k3s-worker-2 - cloud-init wait ===
2026-01-21 18:38:01 - cloud_init_wait           - INFO - cloud-init not found, skipping
2026-01-21 18:38:01 - deploy                    - INFO - Action 'cloud-init wait' for container 'k3s-worker-2' completed successfully
2026-01-21 18:38:01 - deploy                    - INFO - === [Overall: 71%] [Step: 28/39] Executing: k3s-worker-2 - lxc sysctl access configuration ===
2026-01-21 18:38:01 - configure_lxc_sysctl_access - INFO - Configuring LXC container for sysctl access...
2026-01-21 18:38:01 - configure_lxc_sysctl_access - INFO - Adding k3s LXC configuration requirements...
2026-01-21 18:38:01 - configure_lxc_sysctl_access - INFO - Added: lxc.apparmor.profile: unconfined
2026-01-21 18:38:02 - configure_lxc_sysctl_access - INFO - Added: lxc.cap.drop:
2026-01-21 18:38:02 - configure_lxc_sysctl_access - INFO - Added: lxc.mount.auto: proc:rw sys:rw
2026-01-21 18:38:02 - configure_lxc_sysctl_access - INFO - Added: lxc.cgroup2.devices.allow: c 1:11 rwm
2026-01-21 18:38:02 - configure_lxc_sysctl_access - INFO - Container needs to be restarted for k3s LXC configuration to take effect...
2026-01-21 18:38:11 - configure_lxc_sysctl_access - INFO - Container restarted to apply k3s LXC configuration
2026-01-21 18:38:16 - configure_lxc_sysctl_access - INFO - Ensuring /dev/kmsg is configured as symlink to /dev/console (k3s LXC requirement)...
2026-01-21 18:38:17 - configure_lxc_sysctl_access - INFO - /dev/kmsg symlink configured successfully
2026-01-21 18:38:17 - deploy                    - INFO - Action 'lxc sysctl access configuration' for container 'k3s-worker-2' completed successfully
2026-01-21 18:38:17 - deploy                    - INFO - === [Overall: 74%] [Step: 29/39] Executing: k3s-worker-2 - k3s installation ===
2026-01-21 18:38:17 - install_k3s               - INFO - Installing k3s...
2026-01-21 18:38:17 - ssh                       - INFO - SSH connection established to jaal@10.11.4.13
2026-01-21 18:38:18 - install_k3s               - INFO - Skipping k3s agent installation for worker node (will be installed during orchestration)...
2026-01-21 18:38:18 - deploy                    - INFO - Action 'k3s installation' for container 'k3s-worker-2' completed successfully
2026-01-21 18:38:18 - deploy                    - INFO - === [Overall: 76%] [Step: 30/39] Executing: k3s-worker-2 - glusterfs server installation ===
2026-01-21 18:38:18 - install_glusterfs         - INFO - Installing glusterfs-server package...
2026-01-21 18:38:42 - deploy                    - INFO - Action 'glusterfs server installation' for container 'k3s-worker-2' completed successfully
2026-01-21 18:38:42 - ssh                       - INFO - SSH connection closed to jaal@10.11.4.13
2026-01-21 18:38:42 - deploy                    - INFO - === [Overall: 79%] [Step: 31/39] Executing: k3s-worker-3 - create container ===
2026-01-21 18:38:42 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:38:43 - create_container          - INFO - Checking if container 4014 already exists...
2026-01-21 18:38:44 - create_container          - INFO - Creating container 4014 from template...
2026-01-21 18:38:51 - create_container          - INFO - Setting container features...
2026-01-21 18:38:52 - create_container          - INFO - Setting autostart for container 4014 (onboot=1)...
2026-01-21 18:38:53 - create_container          - INFO - Starting container 4014...
2026-01-21 18:38:57 - create_container          - INFO - Bringing up network interface...
2026-01-21 18:38:58 - create_container          - INFO - Network interface is up and reachable
2026-01-21 18:39:01 - create_container          - INFO - Password set for user jaal
2026-01-21 18:39:07 - common                    - INFO - SSH key setup verified successfully
2026-01-21 18:39:11 - create_container          - INFO - Waiting for container to be ready with SSH connectivity (up to 10 minutes)...
2026-01-21 18:39:12 - pct                       - INFO - Container is up!
2026-01-21 18:39:12 - create_container          - INFO - Container 4014 created successfully
2026-01-21 18:39:12 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:39:12 - deploy                    - INFO - Container 'k3s-worker-3' created successfully
2026-01-21 18:39:12 - deploy                    - INFO - Setting up SSH connection to container k3s-worker-3...
2026-01-21 18:39:12 - ssh                       - INFO - SSH connection established to jaal@10.11.4.14
2026-01-21 18:39:14 - deploy                    - INFO - === [Overall: 82%] [Step: 32/39] Executing: k3s-worker-3 - cloud-init wait ===
2026-01-21 18:39:14 - cloud_init_wait           - INFO - cloud-init not found, skipping
2026-01-21 18:39:14 - deploy                    - INFO - Action 'cloud-init wait' for container 'k3s-worker-3' completed successfully
2026-01-21 18:39:14 - deploy                    - INFO - === [Overall: 84%] [Step: 33/39] Executing: k3s-worker-3 - lxc sysctl access configuration ===
2026-01-21 18:39:14 - configure_lxc_sysctl_access - INFO - Configuring LXC container for sysctl access...
2026-01-21 18:39:14 - configure_lxc_sysctl_access - INFO - Adding k3s LXC configuration requirements...
2026-01-21 18:39:14 - configure_lxc_sysctl_access - INFO - Added: lxc.apparmor.profile: unconfined
2026-01-21 18:39:14 - configure_lxc_sysctl_access - INFO - Added: lxc.cap.drop:
2026-01-21 18:39:14 - configure_lxc_sysctl_access - INFO - Added: lxc.mount.auto: proc:rw sys:rw
2026-01-21 18:39:14 - configure_lxc_sysctl_access - INFO - Added: lxc.cgroup2.devices.allow: c 1:11 rwm
2026-01-21 18:39:14 - configure_lxc_sysctl_access - INFO - Container needs to be restarted for k3s LXC configuration to take effect...
2026-01-21 18:39:23 - configure_lxc_sysctl_access - INFO - Container restarted to apply k3s LXC configuration
2026-01-21 18:39:28 - configure_lxc_sysctl_access - INFO - Ensuring /dev/kmsg is configured as symlink to /dev/console (k3s LXC requirement)...
2026-01-21 18:39:30 - configure_lxc_sysctl_access - INFO - /dev/kmsg symlink configured successfully
2026-01-21 18:39:30 - deploy                    - INFO - Action 'lxc sysctl access configuration' for container 'k3s-worker-3' completed successfully
2026-01-21 18:39:30 - deploy                    - INFO - === [Overall: 87%] [Step: 34/39] Executing: k3s-worker-3 - k3s installation ===
2026-01-21 18:39:30 - install_k3s               - INFO - Installing k3s...
2026-01-21 18:39:30 - ssh                       - INFO - SSH connection established to jaal@10.11.4.14
2026-01-21 18:39:30 - install_k3s               - INFO - Skipping k3s agent installation for worker node (will be installed during orchestration)...
2026-01-21 18:39:30 - deploy                    - INFO - Action 'k3s installation' for container 'k3s-worker-3' completed successfully
2026-01-21 18:39:30 - deploy                    - INFO - === [Overall: 89%] [Step: 35/39] Executing: k3s-worker-3 - glusterfs server installation ===
2026-01-21 18:39:30 - install_glusterfs         - INFO - Installing glusterfs-server package...
2026-01-21 18:39:52 - deploy                    - INFO - Action 'glusterfs server installation' for container 'k3s-worker-3' completed successfully
2026-01-21 18:39:52 - ssh                       - INFO - SSH connection closed to jaal@10.11.4.14
2026-01-21 18:39:52 - deploy                    - INFO - === [Overall: 92%] [Step: 36/39] Executing: kubernetes - setup kubernetes ===
2026-01-21 18:39:52 - setup_kubernetes          - INFO - Deploying Kubernetes (k3s) cluster...
2026-01-21 18:39:52 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:39:52 - kubernetes                - INFO - Getting k3s server token...
2026-01-21 18:39:55 - kubernetes                - INFO - k3s token retrieved successfully
2026-01-21 18:39:55 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:39:55 - kubernetes                - INFO - Joining worker 4012 to k3s cluster...
2026-01-21 18:39:56 - kubernetes                - INFO - Installing k3s agent on worker 4012...
2026-01-21 18:40:13 - kubernetes                - INFO - k3s agent installation completed on worker 4012
2026-01-21 18:40:13 - kubernetes                - INFO - Installation output:  to k3s
[INFO]  Creating killall script /usr/local/bin/k3s-killall.sh
[INFO]  Creating uninstall script /usr/local/bin/k3s-agent-uninstall.sh
[INFO]  env: Creating environment file /etc/systemd/system/k3s-agent.service.env
[INFO]  systemd: Creating service file /etc/systemd/system/k3s-agent.service
[INFO]  systemd: Enabling k3s-agent unit
[INFO]  systemd: Starting k3s-agent

Created symlink '/etc/systemd/system/multi-user.target.wants/k3s-agent.service' → '/etc/systemd/system/k3s-agent.service'.
2026-01-21 18:40:15 - kubernetes                - INFO - Creating /dev/kmsg symlink for worker 4012...
2026-01-21 18:40:16 - kubernetes                - INFO - ✓ /dev/kmsg created on worker 4012
2026-01-21 18:40:16 - kubernetes                - INFO - Configuring k3s-agent service to ensure /dev/kmsg exists on startup for worker 4012...
2026-01-21 18:40:18 - kubernetes                - INFO - ✓ Added /dev/kmsg fix to k3s-agent.service on worker 4012
2026-01-21 18:40:24 - kubernetes                - INFO - Worker 4012 (k3s-worker-1) joined cluster successfully and is Ready
2026-01-21 18:40:24 - kubernetes                - INFO - Joining worker 4013 to k3s cluster...
2026-01-21 18:40:25 - kubernetes                - INFO - Installing k3s agent on worker 4013...
2026-01-21 18:40:41 - kubernetes                - INFO - k3s agent installation completed on worker 4013
2026-01-21 18:40:41 - kubernetes                - INFO - Installation output:  to k3s
[INFO]  Creating killall script /usr/local/bin/k3s-killall.sh
[INFO]  Creating uninstall script /usr/local/bin/k3s-agent-uninstall.sh
[INFO]  env: Creating environment file /etc/systemd/system/k3s-agent.service.env
[INFO]  systemd: Creating service file /etc/systemd/system/k3s-agent.service
[INFO]  systemd: Enabling k3s-agent unit
[INFO]  systemd: Starting k3s-agent

Created symlink '/etc/systemd/system/multi-user.target.wants/k3s-agent.service' → '/etc/systemd/system/k3s-agent.service'.
2026-01-21 18:40:43 - kubernetes                - INFO - Creating /dev/kmsg symlink for worker 4013...
2026-01-21 18:40:44 - kubernetes                - INFO - ✓ /dev/kmsg created on worker 4013
2026-01-21 18:40:44 - kubernetes                - INFO - Configuring k3s-agent service to ensure /dev/kmsg exists on startup for worker 4013...
2026-01-21 18:40:46 - kubernetes                - INFO - ✓ Added /dev/kmsg fix to k3s-agent.service on worker 4013
2026-01-21 18:40:51 - kubernetes                - INFO - Worker 4013 (k3s-worker-2) joined cluster successfully and is Ready
2026-01-21 18:40:51 - kubernetes                - INFO - Joining worker 4014 to k3s cluster...
2026-01-21 18:40:53 - kubernetes                - INFO - Installing k3s agent on worker 4014...
2026-01-21 18:41:09 - kubernetes                - INFO - k3s agent installation completed on worker 4014
2026-01-21 18:41:09 - kubernetes                - INFO - Installation output:  to k3s
[INFO]  Creating killall script /usr/local/bin/k3s-killall.sh
[INFO]  Creating uninstall script /usr/local/bin/k3s-agent-uninstall.sh
[INFO]  env: Creating environment file /etc/systemd/system/k3s-agent.service.env
[INFO]  systemd: Creating service file /etc/systemd/system/k3s-agent.service
[INFO]  systemd: Enabling k3s-agent unit
[INFO]  systemd: Starting k3s-agent

Created symlink '/etc/systemd/system/multi-user.target.wants/k3s-agent.service' → '/etc/systemd/system/k3s-agent.service'.
2026-01-21 18:41:11 - kubernetes                - INFO - Creating /dev/kmsg symlink for worker 4014...
2026-01-21 18:41:12 - kubernetes                - INFO - ✓ /dev/kmsg created on worker 4014
2026-01-21 18:41:12 - kubernetes                - INFO - Configuring k3s-agent service to ensure /dev/kmsg exists on startup for worker 4014...
2026-01-21 18:41:15 - kubernetes                - INFO - ✓ Added /dev/kmsg fix to k3s-agent.service on worker 4014
2026-01-21 18:41:20 - kubernetes                - INFO - Worker 4014 (k3s-worker-3) joined cluster successfully and is Ready
2026-01-21 18:41:20 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:41:20 - kubernetes                - INFO - Tainting control plane node to prevent regular pods from scheduling...
2026-01-21 18:41:23 - kubernetes                - INFO - Control plane node tainted successfully - regular pods will not schedule on it
2026-01-21 18:41:23 - kubernetes                - INFO - Rancher installation will be handled by Kubernetes action, skipping automatic installation
2026-01-21 18:41:23 - kubernetes                - INFO - Restarting all k3s nodes to ensure stability...
2026-01-21 18:41:23 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:41:23 - kubernetes                - INFO - Restarting all k3s nodes...
2026-01-21 18:41:23 - kubernetes                - INFO - Restarting control node 4011...
2026-01-21 18:41:44 - kubernetes                - INFO - Restarting worker node 4012...
2026-01-21 18:41:54 - kubernetes                - INFO - Restarting worker node 4013...
2026-01-21 18:42:05 - kubernetes                - INFO - Restarting worker node 4014...
2026-01-21 18:42:15 - kubernetes                - INFO - Waiting for nodes to stabilize after restart...
2026-01-21 18:42:45 - kubernetes                - INFO - Running cluster health verification...
2026-01-21 18:42:45 - verify_kubernetes         - INFO - Verifying k3s cluster health...
2026-01-21 18:42:45 - verify_kubernetes         - INFO - Checking that all nodes are Ready...
2026-01-21 18:42:46 - verify_kubernetes         - INFO - ✓ All 4 nodes are Ready
2026-01-21 18:42:46 - verify_kubernetes         - INFO - Checking for unreachable taints on worker nodes...
2026-01-21 18:42:48 - verify_kubernetes         - INFO - ✓ No unreachable taints found on worker nodes
2026-01-21 18:42:48 - verify_kubernetes         - INFO - Verifying /dev/kmsg exists on all k3s nodes...
2026-01-21 18:42:49 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4011
2026-01-21 18:42:50 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4012
2026-01-21 18:42:51 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4013
2026-01-21 18:42:52 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4014
2026-01-21 18:42:52 - verify_kubernetes         - INFO - Verifying Rancher is accessible...
2026-01-21 18:42:54 - verify_kubernetes         - INFO - ⚠ Rancher service not found, skipping accessibility check
2026-01-21 18:42:54 - verify_kubernetes         - INFO - ✓ All k3s cluster health checks passed
2026-01-21 18:42:54 - kubernetes                - INFO - ✓ All nodes restarted and verified successfully
2026-01-21 18:42:54 - kubernetes                - INFO - Kubernetes (k3s) cluster deployed
2026-01-21 18:42:54 - setup_kubernetes          - INFO - Kubernetes deployment completed successfully.
2026-01-21 18:42:54 - setup_kubernetes          - INFO - Verifying k3s cluster health...
2026-01-21 18:43:04 - verify_kubernetes         - INFO - Verifying k3s cluster health...
2026-01-21 18:43:04 - verify_kubernetes         - INFO - Checking that all nodes are Ready...
2026-01-21 18:43:05 - verify_kubernetes         - INFO - ✓ All 4 nodes are Ready
2026-01-21 18:43:05 - verify_kubernetes         - INFO - Checking for unreachable taints on worker nodes...
2026-01-21 18:43:06 - verify_kubernetes         - INFO - ✓ No unreachable taints found on worker nodes
2026-01-21 18:43:06 - verify_kubernetes         - INFO - Verifying /dev/kmsg exists on all k3s nodes...
2026-01-21 18:43:08 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4011
2026-01-21 18:43:09 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4012
2026-01-21 18:43:10 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4013
2026-01-21 18:43:11 - verify_kubernetes         - INFO - ✓ /dev/kmsg exists on node 4014
2026-01-21 18:43:11 - verify_kubernetes         - INFO - Verifying Rancher is accessible...
2026-01-21 18:43:12 - verify_kubernetes         - INFO - ⚠ Rancher service not found, skipping accessibility check
2026-01-21 18:43:12 - verify_kubernetes         - INFO - ✓ All k3s cluster health checks passed
2026-01-21 18:43:14 - deploy                    - INFO - === [Overall: 94%] [Step: 37/39] Executing: GlusterFS setup ===
2026-01-21 18:43:14 - gluster                   - INFO - [5/7] Setting up GlusterFS distributed storage...
2026-01-21 18:43:14 - gluster                   - INFO - Installing GlusterFS server on all nodes...
2026-01-21 18:43:14 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:43:17 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:43:17 - gluster                   - INFO - Installing on k3s-worker-1...
2026-01-21 18:43:17 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:43:34 - gluster                   - INFO - GlusterFS installed successfully on k3s-worker-1
2026-01-21 18:43:34 - gluster                   - INFO - Starting glusterd service on k3s-worker-1...
2026-01-21 18:43:43 - gluster                   - INFO - k3s-worker-1: GlusterFS installed and glusterd running
2026-01-21 18:43:43 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:43:43 - gluster                   - INFO - Installing on k3s-worker-2...
2026-01-21 18:43:44 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:43:55 - gluster                   - INFO - GlusterFS installed successfully on k3s-worker-2
2026-01-21 18:43:55 - gluster                   - INFO - Starting glusterd service on k3s-worker-2...
2026-01-21 18:44:04 - gluster                   - INFO - k3s-worker-2: GlusterFS installed and glusterd running
2026-01-21 18:44:04 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:44:04 - gluster                   - INFO - Installing on k3s-worker-3...
2026-01-21 18:44:04 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:44:15 - gluster                   - INFO - GlusterFS installed successfully on k3s-worker-3
2026-01-21 18:44:15 - gluster                   - INFO - Starting glusterd service on k3s-worker-3...
2026-01-21 18:44:24 - gluster                   - INFO - k3s-worker-3: GlusterFS installed and glusterd running
2026-01-21 18:44:24 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:44:54 - gluster                   - INFO - Creating brick directories on all nodes...
2026-01-21 18:44:54 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:44:54 - gluster                   - INFO - Creating brick on k3s-worker-1...
2026-01-21 18:44:56 - gluster                   - INFO - Creating brick on k3s-worker-2...
2026-01-21 18:44:57 - gluster                   - INFO - Creating brick on k3s-worker-3...
2026-01-21 18:44:58 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:44:59 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:45:00 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:45:00 - gluster                   - INFO - Peering worker nodes together...
2026-01-21 18:45:00 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:45:00 - gluster                   - INFO - Adding k3s-worker-2 (10.11.4.13) to cluster...
2026-01-21 18:45:01 - gluster                   - INFO - Adding k3s-worker-3 (10.11.4.14) to cluster...
2026-01-21 18:45:13 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:45:13 - gluster                   - INFO - Verifying peer status...
2026-01-21 18:45:13 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:45:14 - gluster                   - INFO - Number of Peers: 2

Hostname: 10.11.4.13
Uuid: d6940cfb-0cce-42d5-bfda-c0557677b777
State: Peer in Cluster (Connected)

Hostname: 10.11.4.14
Uuid: 1f0204d6-d74f-4f0b-9fd8-e401622134b5
State: Peer in Cluster (Connected)
2026-01-21 18:45:14 - gluster                   - INFO - All 2 worker peers connected
2026-01-21 18:45:14 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:45:14 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:45:14 - gluster                   - INFO - Creating GlusterFS volume 'shared-storage'...
2026-01-21 18:45:17 - gluster                   - INFO - volume create: shared-storage: success: please start the volume to access data
2026-01-21 18:45:17 - gluster                   - INFO - Starting volume 'shared-storage'...
2026-01-21 18:45:21 - gluster                   - INFO - volume start: shared-storage: success
2026-01-21 18:45:21 - gluster                   - INFO - Verifying volume status...
2026-01-21 18:45:22 - gluster                   - INFO - Status of volume: shared-storage
Gluster process                             TCP Port  RDMA Port  Online  Pid
------------------------------------------------------------------------------
Brick 10.11.4.12:/gluster/brick             56126     0          Y       3364 
Brick 10.11.4.13:/gluster/brick             53556     0          Y       3112 
Brick 10.11.4.14:/gluster/brick             53246     0          Y       2935 
Self-heal Daemon on localhost               N/A       N/A        Y       3381 
Self-heal Daemon on 10.11.4.13              N/A       N/A        Y       3129 
Self-heal Daemon on 10.11.4.14              N/A       N/A        Y       2952 
 
Task Status of Volume shared-storage
------------------------------------------------------------------------------
There are no active volume tasks
2026-01-21 18:45:22 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:45:22 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:45:22 - gluster                   - INFO - Mounting GlusterFS volume on all nodes...
2026-01-21 18:45:22 - gluster                   - INFO - Mounting on k3s-worker-1...
2026-01-21 18:45:27 - gluster                   - INFO - k3s-worker-1: Volume mounted successfully
2026-01-21 18:45:27 - gluster                   - INFO - Mounting on k3s-worker-2...
2026-01-21 18:45:32 - gluster                   - INFO - k3s-worker-2: Volume mounted successfully
2026-01-21 18:45:32 - gluster                   - INFO - Mounting on k3s-worker-3...
2026-01-21 18:45:37 - gluster                   - INFO - k3s-worker-3: Volume mounted successfully
2026-01-21 18:45:37 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:45:37 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:45:37 - gluster                   - INFO - Mounting GlusterFS volume on 4 client nodes...
2026-01-21 18:45:37 - gluster                   - INFO - Installing glusterfs-client on k3s-control...
2026-01-21 18:46:03 - gluster                   - INFO - Installing glusterfs-client on k3s-worker-1...
2026-01-21 18:46:04 - gluster                   - INFO - glusterfs-client already installed on k3s-worker-1
2026-01-21 18:46:04 - gluster                   - INFO - Installing glusterfs-client on k3s-worker-2...
2026-01-21 18:46:05 - gluster                   - INFO - glusterfs-client already installed on k3s-worker-2
2026-01-21 18:46:05 - gluster                   - INFO - Installing glusterfs-client on k3s-worker-3...
2026-01-21 18:46:06 - gluster                   - INFO - glusterfs-client already installed on k3s-worker-3
2026-01-21 18:46:06 - gluster                   - INFO - Mounting GlusterFS on k3s-control...
2026-01-21 18:46:13 - gluster                   - INFO - GlusterFS mounted successfully on k3s-control
2026-01-21 18:46:13 - gluster                   - INFO - Mounting GlusterFS on k3s-worker-1...
2026-01-21 18:46:18 - gluster                   - INFO - GlusterFS already mounted on k3s-worker-1
2026-01-21 18:46:18 - gluster                   - INFO - Mounting GlusterFS on k3s-worker-2...
2026-01-21 18:46:23 - gluster                   - INFO - GlusterFS already mounted on k3s-worker-2
2026-01-21 18:46:23 - gluster                   - INFO - Mounting GlusterFS on k3s-worker-3...
2026-01-21 18:46:28 - gluster                   - INFO - GlusterFS already mounted on k3s-worker-3
2026-01-21 18:46:28 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:46:28 - gluster                   - INFO - GlusterFS distributed storage setup complete
2026-01-21 18:46:28 - gluster                   - INFO -   Volume: shared-storage
2026-01-21 18:46:28 - gluster                   - INFO -   Mount point: /mnt/gluster on all nodes
2026-01-21 18:46:28 - gluster                   - INFO -   Replication: 3x
2026-01-21 18:46:28 - ssh                       - INFO - SSH connection established to jaal@10.11.4.11
2026-01-21 18:46:28 - deploy                    - INFO - === [Overall: 97%] [Step: 38/39] Executing: Kubernetes action - install rancher ===
2026-01-21 18:46:28 - install_rancher           - INFO - Installing Rancher on Kubernetes cluster...
2026-01-21 18:46:28 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:46:28 - kubernetes                - INFO - Installing Rancher...
2026-01-21 18:46:29 - kubernetes                - INFO - Verifying k3s service is running...
2026-01-21 18:46:30 - kubernetes                - INFO - k3s service is running
2026-01-21 18:46:30 - kubernetes                - INFO - Updating k3s kubeconfig with control node IP...
2026-01-21 18:46:33 - kubernetes                - INFO - Verifying kubectl works without KUBECONFIG specified...
2026-01-21 18:46:34 - kubernetes                - INFO - kubectl works correctly without KUBECONFIG specified
2026-01-21 18:46:34 - kubernetes                - INFO - Verifying Kubernetes API is reachable...
2026-01-21 18:46:35 - kubernetes                - INFO - Kubernetes API is reachable
2026-01-21 18:46:35 - kubernetes                - INFO - Waiting for CNI plugin (Flannel) to be ready...
2026-01-21 18:46:42 - kubernetes                - INFO - CNI plugin (Flannel) is ready - nodes Ready, CNI config exists, Flannel subnet exists, system pods running
2026-01-21 18:46:43 - kubernetes                - INFO - Installing cert-manager...
2026-01-21 18:46:45 - kubernetes                - INFO - cert-manager resources applied successfully
2026-01-21 18:46:47 - kubernetes                - INFO - cert-manager installed and verified successfully
2026-01-21 18:46:47 - kubernetes                - INFO - Waiting for cert-manager webhook to be ready...
2026-01-21 18:46:48 - kubernetes                - INFO - Waiting for cert-manager webhook to be ready (waited 0/300 seconds)...
2026-01-21 18:46:48 - kubernetes                - INFO - Webhook pods status: False
2026-01-21 18:47:01 - kubernetes                - INFO - cert-manager webhook is ready with 1 pod(s) and endpoints available
2026-01-21 18:47:01 - kubernetes                - INFO - Verifying Kubernetes API is reachable...
2026-01-21 18:47:02 - kubernetes                - INFO - Kubernetes API is reachable
2026-01-21 18:47:02 - kubernetes                - INFO - Verifying Kubernetes API server stability...
2026-01-21 18:47:04 - kubernetes                - INFO - API server check 1/3 passed
2026-01-21 18:47:07 - kubernetes                - INFO - API server check 2/3 passed
2026-01-21 18:47:10 - kubernetes                - INFO - API server check 3/3 passed
2026-01-21 18:47:12 - kubernetes                - INFO - Installing Rancher using Helm...
2026-01-21 18:47:13 - kubernetes                - INFO - Installing Helm...
2026-01-21 18:47:22 - kubernetes                - INFO - Rancher installed successfully
2026-01-21 18:47:22 - kubernetes                - INFO - Setting Rancher service NodePort to 30443...
2026-01-21 18:47:25 - kubernetes                - INFO - Rancher service NodePort set to 30443
2026-01-21 18:47:25 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:47:25 - install_rancher           - INFO - Rancher installed successfully.
2026-01-21 18:47:25 - deploy                    - INFO - === [Overall: 100%] [Step: 39/39] Executing: Kubernetes action - install argocd ===
2026-01-21 18:47:25 - install_argocd            - INFO - Installing ArgoCD on Kubernetes cluster...
2026-01-21 18:47:25 - ssh                       - INFO - SSH connection established to root@10.11.4.4
2026-01-21 18:47:25 - install_argocd            - INFO - Checking kubectl...
2026-01-21 18:47:26 - install_argocd            - INFO - Creating ArgoCD namespace...
2026-01-21 18:47:28 - install_argocd            - INFO - Installing ArgoCD using kubectl apply...
2026-01-21 18:47:32 - install_argocd            - INFO - ArgoCD installation started successfully
2026-01-21 18:47:32 - install_argocd            - INFO - Waiting for ArgoCD server service to be created...
2026-01-21 18:47:33 - install_argocd            - INFO - ArgoCD server service created
2026-01-21 18:47:33 - install_argocd            - INFO - Patching ArgoCD server service to NodePort on port 30080...
2026-01-21 18:47:35 - install_argocd            - INFO - ArgoCD server service patched to NodePort 30080 (HTTP) and 30081 (HTTPS)
2026-01-21 18:47:35 - install_argocd            - INFO - Waiting for ArgoCD pods to be ready...
2026-01-21 18:47:37 - install_argocd            - INFO - Waiting for ArgoCD pods to be ready (waited 0/600 seconds)...
2026-01-21 18:48:14 - install_argocd            - INFO - Waiting for ArgoCD pods to be ready (waited 30/600 seconds)...
2026-01-21 18:48:26 - install_argocd            - INFO - ArgoCD server pod is ready
2026-01-21 18:48:26 - install_argocd            - INFO - ArgoCD installed successfully on NodePort 30080
2026-01-21 18:48:26 - install_argocd            - INFO - ArgoCD admin password can be retrieved with: kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d
2026-01-21 18:48:26 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
2026-01-21 18:48:26 - ssh                       - INFO - SSH connection closed to jaal@10.11.4.11
2026-01-21 18:48:26 - deploy                    - INFO - Checking service ports...
2026-01-21 18:48:31 - deploy                    - INFO -   ✓ GlusterFS: 10.11.4.12:24007
2026-01-21 18:48:31 - deploy                    - INFO -   ✗ Rancher: 10.11.4.11:30443 - NOT RESPONDING
2026-01-21 18:48:31 - deploy                    - INFO - === Deploy Complete (with port failures) ===
2026-01-21 18:48:31 - deploy                    - INFO - Containers:
2026-01-21 18:48:31 - deploy                    - INFO -   - 4017: haproxy (10.11.4.17)
2026-01-21 18:48:31 - deploy                    - INFO -   - 4011: k3s-control (10.11.4.11)
2026-01-21 18:48:31 - deploy                    - INFO -   - 4012: k3s-worker-1 (10.11.4.12)
2026-01-21 18:48:31 - deploy                    - INFO -   - 4013: k3s-worker-2 (10.11.4.13)
2026-01-21 18:48:31 - deploy                    - INFO -   - 4014: k3s-worker-3 (10.11.4.14)
2026-01-21 18:48:31 - deploy                    - INFO - HAProxy: http://10.11.4.17:80 (Stats: http://10.11.4.17:8404)
2026-01-21 18:48:31 - deploy                    - INFO - GlusterFS:
2026-01-21 18:48:31 - deploy                    - INFO -   Volume: shared-storage
2026-01-21 18:48:31 - deploy                    - INFO -   Mount: /mnt/gluster on all nodes
2026-01-21 18:48:31 - deploy                    - INFO - Rancher: https://10.11.4.11:30443
2026-01-21 18:48:31 - deploy                    - INFO -   Bootstrap Password: admin
2026-01-21 18:48:31 - deploy                    - INFO - ⚠ Port Status:
2026-01-21 18:48:31 - deploy                    - INFO -   The following ports are NOT responding:
2026-01-21 18:48:31 - deploy                    - INFO -     ✗ Rancher: 10.11.4.11:30443
2026-01-21 18:48:31 - deploy                    - INFO - Error during deployment: Deploy failed: The following ports are not responding:
  - Rancher: 10.11.4.11:30443

2026-01-21 18:48:31 - ssh                       - INFO - SSH connection closed to root@10.11.4.4
